{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "AccountForm"
    },
    "designerId": "6fbcda8a-ee79-4752-b45f-6775c527fa37",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onAccountFormShow",
                "implHandler": [
                    "/*component.on('hide', function() {",
                    "    setTimeout(function() {",
                    "        component.destroy();",
                    "    }, 1000);",
                    "});*/"
                ],
                "name": "show",
                "designer|targetType": "Ext.form.Panel",
                "designer|controlQuery": "formpanel#accountForm"
            },
            "designerId": "60db6978-1a6e-409d-9eaf-8cc41eca7435"
        },
        {
            "type": "Ext.app.Route",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "url": "accountForm",
                "fn": "showAccountForm",
                "implHandler": [
                    "var main = Ext.getCmp('main'),",
                    "    addUser = Ext.create('FP.view.AccountForm'),",
                    "    back = main.query('#back')[0],",
                    "    menuButton = main.query('#menuButton')[0],",
                    "    addUserButton = main.query('#addUser')[0];",
                    "",
                    "",
                    "addUserButton.hide();",
                    "back.view = '#accountForm';",
                    "back.show();",
                    "menuButton.hide();",
                    "",
                    "main.setActiveItem(addUser);"
                ]
            },
            "designerId": "6a092bdb-6d75-406c-bafa-0b0967367a3a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSubmitUserTap",
                "implHandler": [
                    "var account = Ext.ComponentQuery.query('#accountForm')[0],",
                    "    accountValues = account.getValues(),",
                    "    store = Ext.getStore('accounts'),",
                    "    model = Ext.create('FP.model.Account', accountValues),",
                    "    errorMessage,",
                    "    errors = model.validate();",
                    "",
                    "",
                    "if(account.edit) {",
                    "    // get record in local storage and set new values and sync...",
                    "    var id = FP.config.Runtime.getAccount().id,",
                    "        index = store.findExact('id', id),",
                    "        record = store.getAt(index);",
                    "",
                    "    record.set('firstName', accountValues.firstName);",
                    "    record.set('lastName', accountValues.lastName);",
                    "",
                    "    store.sync();",
                    "    this.redirectTo('accounts');",
                    "",
                    "",
                    "} else {",
                    "",
                    "    if(!errors.isValid()) {",
                    "        errors.each(function(err) {",
                    "            errorMessage += err.getMessage() + '\\n';",
                    "        });",
                    "",
                    "        alert('Work in progress'+errorMessage);",
                    "        console.log(errorMessage);",
                    "",
                    "    } else {",
                    "        ",
                    "        model.set('accounts', 0);",
                    "        store.add(model);",
                    "        store.sync();",
                    "",
                    "        this.redirectTo('accounts');",
                    "    }",
                    "}"
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "button#submitUser"
            },
            "designerId": "ee3b6473-957f-4e82-81b4-d6a4252cf312"
        },
        {
            "type": "Ext.app.Route",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "url": "accountForm/edit",
                "fn": "showAccountFormEdit",
                "implHandler": [
                    "var main = Ext.getCmp('main'),",
                    "    editUser = Ext.create('FP.view.AccountForm'),",
                    "    back = main.query('#back')[0],",
                    "    menuButton = main.query('#menuButton')[0],",
                    "    addUserButton = main.query('#addUser')[0],",
                    "    editUserButton = main.query('#editUser')[0],",
                    "    runtime = FP.config.Runtime,",
                    "    userValues = runtime.getAccount();",
                    "",
                    "editUser.edit = true;",
                    "console.log(runtime.getAccount());",
                    "editUser.setValues(userValues);",
                    "",
                    "editUserButton.show();",
                    "addUserButton.hide();",
                    "back.hide();",
                    "menuButton.hide();",
                    "",
                    "main.setActiveItem(editUser);"
                ]
            },
            "designerId": "186dba82-43e3-44dc-befb-ad625dbe14b2"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onDeleteUserTap",
                "implHandler": [
                    "this.deleteUser();"
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "button#deleteUser"
            },
            "designerId": "1504ec95-02de-4f24-a496-0bec5ce713a7"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "deleteUser",
                "implHandler": [
                    ""
                ]
            },
            "designerId": "69bc32da-f128-4dce-8ce3-e12f37adcd77"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onTakeImageButtonTap",
                "implHandler": [
                    "//console.log(FP.app.takePicture());",
                    "//Ext.ComponentQuery.query('#image')[0].setValue('hey');",
                    "",
                    "/****",
                    "* Phonegap specific code",
                    "* Camera Capture",
                    "*",
                    "***/",
                    "var me = this;",
                    "var settings = {",
                    "    quality: 90,",
                    "    sourceType : Camera.PictureSourceType.PHOTOLIBRARY,",
                    "    encodingType: Camera.EncodingType.JPEG,",
                    "    destinationType: Camera.DestinationType.DATA_URL,",
                    "    saveToPhotoAlbum: false,",
                    "    allowEdit : true,",
                    "    targetWidth: 350,",
                    "    targetHeight: 350,",
                    "    correctOrientation: true",
                    "};",
                    "",
                    "",
                    "navigator.camera.getPicture(onSuccess, onFail, settings);",
                    "",
                    "function onSuccess(imageData) {",
                    "",
                    "    //console.log(imageData);",
                    "    console.log(Ext.ComponentQuery.query('#image')[0]);",
                    "    Ext.ComponentQuery.query('#image')[0].setValue('data:image/jpeg;base64,'+imageData);",
                    "",
                    "}",
                    "",
                    "function onFail(message) {",
                    "    //alert('Failed because: ' + message);",
                    "    //dataview.show();",
                    "}"
                ],
                "name": "tap",
                "designer|targetType": "Ext.Button",
                "designer|controlQuery": "button#takeImageButton"
            },
            "designerId": "6c84c256-e9e0-463a-a5a3-38ded3421e77"
        }
    ]
}